SELECT [T3_費用年月], D2_流水編號, [D3_身份證統一編號], [D30_診治醫事人員代號], 醫師資料.姓名 from (select [T3_費用年月],D2_流水編號,[D3_身份證統一編號],[D30_診治醫事人員代號] FROM [192.168.255.12].[NTPC_Report].[dbo].[dtlfa_o_XML]	where [D19_國際疾病分類碼一] in (select ICD_10_代碼 from 感染科.dbo.URI診斷碼) and [T3_費用年月] = '%s'	union select [T3_費用年月], D2_流水編號, [D3_身份證統一編號], [D30_診治醫事人員代號] FROM [192.168.255.12].[NTPC_Report].[dbo].[dtlfa_o_XML] where [D20_國際疾病分類碼二] in (select ICD_10_代碼 from 感染科.dbo.URI診斷碼) and [T3_費用年月] = '%s' union select [T3_費用年月], D2_流水編號, [D3_身份證統一編號], [D30_診治醫事人員代號] FROM [192.168.255.12].[NTPC_Report].[dbo].[dtlfa_o_XML] where [D21_國際疾病分類碼三] in (select ICD_10_代碼 from 感染科.dbo.URI診斷碼 ) and [T3_費用年月] = '%s' union select [T3_費用年月], D2_流水編號, [D3_身份證統一編號], [D30_診治醫事人員代號]	FROM [192.168.255.12].[NTPC_Report].[dbo].[dtlfa_o_XML]	where [D22_國際疾病分類碼四] in (select ICD_10_代碼 from 感染科.dbo.URI診斷碼) and [T3_費用年月] = '%s' union select [T3_費用年月], D2_流水編號, [D3_身份證統一編號], [D30_診治醫事人員代號] FROM [192.168.255.12].[NTPC_Report].[dbo].[dtlfa_o_XML] where [D23_國際疾病分類碼五] in (select ICD_10_代碼 from 感染科.dbo.URI診斷碼) and [T3_費用年月] = '%s') AS A LEFT JOIN (select LOGIN_ID, IDNO as 身分證統一編號, USR_NAME as 姓名 From OPENQUERY(ORACLE,'select LOGIN_ID,IDNO,USR_NAME from Q0004.FTH005K ')) 醫師資料 on A.D30_診治醫事人員代號 collate Chinese_Taiwan_Stroke_CI_AS = 醫師資料.身分證統一編號 collate Chinese_Taiwan_Stroke_CI_AS 
SELECT da.[T3_費用年月], da.[D8_就醫科別], da.[D9_就醫日期], da.[D3_身份證統一編號], isnull (hh_mhpat.[ehpat_no],0) as 病歷號碼, isnull (hh_mhpat.[ehpat_name],'') as 病人姓名, da.[D11_出生年月日], isnull (da.[D19_國際疾病分類碼一],'') as 疾病碼一, [感染科].dbo.icd10toName(isnull(da.[D19_國際疾病分類碼一],'')) as 疾病名一, isnull (da.[D20_國際疾病分類碼二],'') as 疾病碼二, [感染科].dbo.icd10toName(isnull(da.[D20_國際疾病分類碼二],'')) as 疾病名二, isnull (da.[D21_國際疾病分類碼三],'') as 疾病碼三, [感染科].dbo.icd10toName(isnull(da.[D21_國際疾病分類碼三],'')) as 疾病名三, isnull (da.[D22_國際疾病分類碼四],'') as 疾病碼四, [感染科].dbo.icd10toName(isnull(da.[D22_國際疾病分類碼四],'')) as 疾病名四, isnull (da.[D23_國際疾病分類碼五],'') as 疾病碼五, [感染科].dbo.icd10toName(isnull(da.[D23_國際疾病分類碼五],'')) as 疾病名五, da.[D30_診治醫事人員代號], Dr.[姓名] FROM [192.168.255.12].[NTPC_Report].[dbo].[dtlfa_o_XML] as da LEFT JOIN  [TamisHEMR].[dbo].[EMR_MEhpat] as hh_mhpat ON da.[D3_身份證統一編號] COLLATE Chinese_Taiwan_Stroke_CI_AS = hh_mhpat.[ehpat_idno] COLLATE Chinese_Taiwan_Stroke_CI_AS LEFT JOIN  [192.168.255.12].[HIS基本資料].[dbo].[醫師資料表] as Dr ON da.[D30_診治醫事人員代號] = Dr.[身分證統一編號] WHERE da.[T3_費用年月] = '%s' and (da.[D19_國際疾病分類碼一] IN (SELECT a.ICD_10_Code FROM 感染科.dbo.性病清單 as A) or da.[D20_國際疾病分類碼二] IN (SELECT a.ICD_10_Code FROM 感染科.dbo.性病清單 as A) or da.[D21_國際疾病分類碼三] IN (SELECT a.ICD_10_Code FROM 感染科.dbo.性病清單 as A) or da.[D22_國際疾病分類碼四] IN (SELECT a.ICD_10_Code FROM 感染科.dbo.性病清單 as A) or da.[D23_國際疾病分類碼五] IN (SELECT a.ICD_10_Code FROM 感染科.dbo.性病清單 as A));


